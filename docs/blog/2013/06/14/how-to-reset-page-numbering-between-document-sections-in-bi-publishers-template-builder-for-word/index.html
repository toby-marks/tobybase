<!DOCTYPE html>
<html class="no-js" lang="en-US" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="description" content="How To Reset Page Numbering Between Document Sections in BI Publisher&#39;s Template Builder for Word">
    <meta name="author" content="Toby Marks">

    <meta name="keyword" content="">
    <link rel="shortcut icon" href="/favicon.ico">

    <title>How To Reset Page Numbering Between Document Sections in BI Publisher&#39;s Template Builder for Word &middot; tobybase</title>

   	
    
        <link rel="preload" href="http://www.tobybase.com//css/theme/cosmo.css" as="style" onload="this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="http://www.tobybase.com//css/theme/cosmo.css"></noscript>
    

    <link rel="preload" href="http://www.tobybase.com//css/font-awesome.min.css" as="stylesheet" onload="this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="http://www.tobybase.com//css/font-awesome.min.css"></noscript>

   	
   	<link rel="preload" href="http://www.tobybase.com//css/style.css" as="stylesheet" onload="this.rel='stylesheet'">
   	<noscript><link rel="stylesheet" href="http://www.tobybase.com//css/style.css"></noscript>

    <script>
 
(function(w){
	"use strict";
	 
	var loadCSS = function( href, before, media ){
		
		
		
			
		
		var doc = w.document;
		var ss = doc.createElement( "link" );
		var ref;
		if( before ){
			ref = before;
		}
		else {
			var refs = ( doc.body || doc.getElementsByTagName( "head" )[ 0 ] ).childNodes;
			ref = refs[ refs.length - 1];
		}

		var sheets = doc.styleSheets;
		ss.rel = "stylesheet";
		ss.href = href;
		
		ss.media = "only x";

		
		function ready( cb ){
			if( doc.body ){
				return cb();
			}
			setTimeout(function(){
				ready( cb );
			});
		}
		
			
			
		ready( function(){
			ref.parentNode.insertBefore( ss, ( before ? ref : ref.nextSibling ) );
		});
		
		var onloadcssdefined = function( cb ){
			var resolvedHref = ss.href;
			var i = sheets.length;
			while( i-- ){
				if( sheets[ i ].href === resolvedHref ){
					return cb();
				}
			}
			setTimeout(function() {
				onloadcssdefined( cb );
			});
		};

		function loadCB(){
			if( ss.addEventListener ){
				ss.removeEventListener( "load", loadCB );
			}
			ss.media = media || "all";
		}

		
		if( ss.addEventListener ){
			ss.addEventListener( "load", loadCB);
		}
		ss.onloadcssdefined = onloadcssdefined;
		onloadcssdefined( loadCB );
		return ss;
	};
	
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ));
 
(function( w ){
  
  if( !w.loadCSS ){
    return;
  }
  var rp = loadCSS.relpreload = {};
  rp.support = function(){
    try {
      return w.document.createElement( "link" ).relList.supports( "preload" );
    } catch (e) {
      return false;
    }
  };

  
  rp.poly = function(){
    var links = w.document.getElementsByTagName( "link" );
    for( var i = 0; i < links.length; i++ ){
      var link = links[ i ];
      if( link.rel === "preload" && link.getAttribute( "as" ) === "style" ){
        w.loadCSS( link.href, link, link.getAttribute( "media" ) );
        link.rel = null;
      }
    }
  };

  
  if( !rp.support() ){
    rp.poly();
    var run = w.setInterval( rp.poly, 300 );
    if( w.addEventListener ){
      w.addEventListener( "load", function(){
        rp.poly();
        w.clearInterval( run );
      } );
    }
    if( w.attachEvent ){
      w.attachEvent( "onload", function(){
        w.clearInterval( run );
      } )
    }
  }
}( this ));
    </script>
    
    
    <link href="" rel="alternate" type="application/rss+xml" title="tobybase" />
</head>
<body lang="en-US">
    
    <div class="container">
    <div class="row">
        <div class="navbar navbar-default " role="navigation">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://www.tobybase.com/"><img src="http://www.tobybase.com/img/logo.png" height="100%"></a>
            </div>
            <div class="navbar-collapse collapse navbar-responsive-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="http://www.tobybase.com/">Home</a></li>
                    <li><a href="http://www.tobybase.com//post/">Blog</a></li>
                    
                </ul>
            </div>
        </div>
    </div>
</div>



<div class="container">
	<div class="row">
		<div class="col-md-offset-1 col-md-10">
			<h3>How To Reset Page Numbering Between Document Sections in BI Publisher&#39;s Template Builder for Word</h3>
				<span class="label label-primary">06/14/2013</span> in 
				
					
					<a href="/categories/howtos">HowTos</a>
				 using tags
				
					
					<a href="/tags/oracle">oracle</a>
				
					 , 
					<a href="/tags/bi-publisher">bi publisher</a>
				
					 , 
					<a href="/tags/bi">bi</a>
				
					 , 
					<a href="/tags/reporting">reporting</a>
				
			</small>
		</div>
	</div>
	<div class="row">
		<div class="col-md-offset-1 col-md-10">
			<br>
			<p>Under normal circumstances, it is fairly easy in Microsoft Word to <a href="http://www.youtube.com/watch?v=E1WtKR6FDM4">reset page numbering</a> when starting a new section of your document. However, such a simple thing can be non-trivial when dealing with the BI Publisher Template Builder plugin for Microsoft Office (<a href="http://www.oracle.com/technetwork/middleware/bi-publisher/downloads/index.html">available from Oracle</a> â€” see BI Publisher Desktop).</p>

<p>In short, doing this the normal way did not work for me, and in researching the issue I ran across a <a href="http://stackoverflow.com/questions/9603481/rtf-number-of-pages-page-x-of-y">number</a> <a href="https://forums.oracle.com/thread/2493003">of</a> <a href="https://forums.oracle.com/thread/496869">folks</a> who were having the same problem. Page numbering was simply not being reset between sections, or worse, did not take into account a fluid document size based upon available data.</p>

<p><img src="/img/2013-06-14-resetting-page-numbering-between-document-sections-in-bi-publishers-template-builder-for-word/9f704cdbd7a5ec85bff722e3469edae0993faa219b4e42459782b94f692aa53e.png" alt="" /></p>

<p>One <a href="https://forums.oracle.com/thread/2225641">suggestion I read</a> said to wrap the page number cells in a BI Publisher repeating group using for-each@section, like so:</p>

<p><code>&lt;?for-each@section:ID?&gt; x/y &lt;?end for-each?&gt;</code></p>

<p>But this also didn&rsquo;t work for me. Finally I had to edit the RTF file directly.</p>

<p>The <a href="http://www.biblioscape.com/rtf15_spec.htm">RTF specification</a> was of some help to me in doing this, as well as <a href="http://msdn.microsoft.com/en-us/library/office/aa140283(v=office.10).aspx#rtfspec_secformatprop">this explanatory page from Microsoft</a>.</p>

<p>RTF files can be a little confusing, but most of the &ldquo;junk&rdquo; in the files is just special codes for formatting the text. I was able to find my way around easily enough by searching for labels or keywords from the document. By searching for the first few words from the second section of the document (in this case, &ldquo;Sender&rsquo;s Receipt&rdquo;), I was able to spot where the section break should go.</p>

<p><img src="/img/2013-06-14-resetting-page-numbering-between-document-sections-in-bi-publishers-template-builder-for-word/0d902604df4939682bb7821c4044affb3b03f809274551b8172827bc846d7b2d.png" alt="" /></p>

<p>Checking the RTF spec, I could see that the <code>\page</code> directive shown above was the page break between two sections of my document where I wanted to reset the page numbering. To create the section break, I inserted the following RTF directives at that point:</p>

<p><code>\sect \sectd \pgnstarts1\pgnrestart</code></p>

<p><img src="/img/2013-06-14-resetting-page-numbering-between-document-sections-in-bi-publishers-template-builder-for-word/466447c609e7fa65f188357e7531def7cb8f1443944e602f62e3eff984f1388d.png" alt="" /></p>

<p>Since the default behavior of the section break is to start on a new page, I found I had to remove the <code>\page</code> directive to avoid an extra page being inserted between the document sections.</p>

<p>Interestingly, resetting the page numbering also works when calculating total number of pages, whereby the total is from the section, not the entire document, even though the NumPages field is used instead of SectionPages! Go figure, but it worked for me.</p>

<p><img src="/img/2013-06-14-resetting-page-numbering-between-document-sections-in-bi-publishers-template-builder-for-word/1efc8813e70f4ee7bda4647b6fd38f4dce646c46b41e20fb482a3443e5bbb17a.png" alt="" /></p>

		</div>
	</div>
	<div class="row">
		<div class="col-md-12">
			<hr>
		</div>
	</div>
</div>

    <div class="container">
        <div class="row col-md-12">
            <footer>
                <div class="pull-left">
                    <p>
                        &copy; 2015 ~ Toby Marks ~ Powered By <a href="http://hugo.spf13.com">Hugo</a> ~ <a href="http://www.tobybase.com//license/">License</a>
                    </p>
                </div>

                
                <div class="pull-right">
                    
                        <a href="https://www.linkedin.com/in/tobymarks" target="_blank">
                        <i class="fa fa-linkedin fa-2x"></i></a>
                    
                    
                    
                        <a href="https://twitter.com/toby_marks" target="_blank">
                        <i class="fa fa-twitter-square fa-2x"></i></a>
                    
                    
                        <a href="https://github.com/toby-marks" target="_blank">
                        <i class="fa fa-github-square fa-2x"></i></a>
                    
                    
                    
                    
                </div>
            </footer>
        </div>
    </div>

    
    <script src="http://www.tobybase.com//js/jquery.min-2.1.4.js"></script>
    <script src="http://www.tobybase.com//js/bootstrap.min-3.3.5.js"></script>

    
    </body>
</html>


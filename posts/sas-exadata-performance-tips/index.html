<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">

    <meta name="author" content="Toby Marks">
    <meta name="description" content="Some helpful tips for boosting the performance of SAS queries on Oracle database.">
    <meta name="keywords" content="oracle,infolob,blog,consultant,developer,tuning,exadata,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="3 Tips for Running SAS Queries on Oracle"/>
<meta name="twitter:description" content="Some helpful tips for boosting the performance of SAS queries on Oracle database."/>

    <meta property="og:title" content="3 Tips for Running SAS Queries on Oracle" />
<meta property="og:description" content="Some helpful tips for boosting the performance of SAS queries on Oracle database." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://tobybase.com/posts/sas-exadata-performance-tips/" />
<meta property="article:published_time" content="2019-09-23T13:54:50-05:00" />
<meta property="article:modified_time" content="2019-09-23T13:54:50-05:00" />


    
      <base href="http://tobybase.com/posts/sas-exadata-performance-tips/">
    
    <title>
  3 Tips for Running SAS Queries on Oracle ¬∑ üë®üèª‚Äçüíª Tobybase
</title>

    
      <link rel="canonical" href="http://tobybase.com/posts/sas-exadata-performance-tips/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.0/css/all.css" integrity="sha384-Bfad6CLCknfcloXFOyFnlgtENryhrpZCe29RTifKEixXQZ38WheV+i/6YWSzkz3V" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="http://tobybase.com/css/coder.min.a4f332213a21ce8eb521670c614470c58923aaaf385e2a73982c31dd7642decb.css" integrity="sha256-pPMyITohzo61IWcMYURwxYkjqq84XipzmCwx3XZC3ss=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="http://tobybase.com/css/custom.css" />
    

    

    <link rel="icon" type="image/png" href="http://tobybase.com/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="http://tobybase.com/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.71.0" />
  </head>

  
  
  <body class="colorscheme-light">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="http://tobybase.com/">
      üë®üèª‚Äçüíª Tobybase
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://tobybase.com/posts/">Blog</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://tobybase.com/links/">Links</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="http://tobybase.com/about/">About</a>
          </li>
        
      
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">3 Tips for Running SAS Queries on Oracle</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2019-09-23T13:54:50-05:00'>
                September 23, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              3-minute read
            </span>
          </div>
          <div class="categories">
  <i class="fas fa-folder"></i>
    <a href="http://tobybase.com/categories/database/">Database</a>
      <span class="separator">‚Ä¢</span>
    <a href="http://tobybase.com/categories/tools/">Tools</a></div>

          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="http://tobybase.com/tags/sql/">sql</a>
      <span class="separator">‚Ä¢</span>
    <a href="http://tobybase.com/tags/sas/">sas</a>
      <span class="separator">‚Ä¢</span>
    <a href="http://tobybase.com/tags/oracle/">oracle</a></div>

        </div>
      </header>

      <div>
        
        <p>I don&rsquo;t know a whole lot about SAS, but on my current gig I am frequently called upon to tune queries that run in that environment. Here are three things I have learned to keep in mind as a SAS developer when running against Oracle database.</p>
<h3 id="use-preserve_comments">Use PRESERVE_COMMENTS</h3>
<p>This is most critical. In Oracle, SQL hints are specified in a specially formatted inline comment. Running a query or DML statement without those hints could be detrimental to performance.</p>
<p>To retain these hints in SAS you will need to add the <em>Preserve_Comments</em> option to the CONNECT statement. Then any hints you add to your queries will be passed through to the Oracle optimizer.</p>
<p>Here&rsquo;s an example:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Proc Sql;
 
Connect to Oracle (Uid = XXXX PW = &#39;XXXX&#39; Path = MyConnection Preserve_Comments);
 
Create Table A1 as Select * From Connection To Oracle (
	SELECT /*+ PARALLEL(4) */ * FROM myschema.mytable
);

Disconnect From Oracle;

Quit;                              
</code></pre></div><p>Restriction: This option is valid only in the explicit SQL pass-through method, not in the implicit libname method. For more details on implicit and explicit connection methods please click here</p>
<h3 id="use-readbuff-to-optimize-fetches">Use ReadBuff to Optimize Fetches</h3>
<p><em>ReadBuff</em> is another connection option that can be used to enhance query performance, especially when running queries against Oracle Exadata. It allows you to specify the number of rows that are held in memory for input into SAS. Just be careful not to set this too high, or you may run out of memory.</p>
<p>A value of <code>ReadBuff = 1</code> means that one row is fetched from the database at a time. For large queries this can be very inefficient. If you don&rsquo;t specify a value for ReadBuff, the number of rows returned is set to the default, which can be anywhere from one row to a &ldquo;best guess&rdquo; estimate based on the row length of your data. It is recommended that users start with a buffer size of 5000, increasing or decreasing in increments of 500 until you determine the optimum buffer size for your purposes.</p>
<p>If you set this number too high (e.g. one million records) you can grind your system to a halt as your server struggles to retrieve all that data over the network and load it into memory. It&rsquo;s better to start with smaller increments of no more than 100,000, depending on the size of your records.</p>
<p>For example:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Libname MyLIB Oracle Uid=XXXX PW=&#39;XXXX&#39; Path=MyConnection ReadBuff=100000;
 
Data A1;
Set myschema.mytable;
Run;
 
Proc Sql;

Connect to Oracle (Uid = ‚ÄòXXXX‚Äô PW = &#39;XXXX&#39; Path = MyConnection ReadBuff=100000);

Create Table A1 as Select * From Connection To Oracle (
	SELECT * FROM myschema.mytable
);

Disconnect From Oracle;

Quit;
</code></pre></div><h3 id="use-insertbuff-to-optimize-dml">Use InsertBuff to Optimize DML</h3>
<p>InsertBuff works much the same way as ReadBuff. It uses memory to cache rows so that you can insert many records into Oracle at a time, as opposed to executing many single row inserts. As a general rule of thumb we tended to use <code>InsertBuff = 100000</code>. The SAS engine calculates how many rows it can insert at one time. The same caveats apply about not setting this value too high; just make sure you&rsquo;re not using up all your available memory. And test to optimize the setting for your purposes and hardware configuration.</p>
<p>An example of using InsertBuff:</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Libname MyLIB Oracle Uid=XXXX[My_Group_Space] PW=&#39;XXXX&#39; Path=MyConnection InsertBuff=100000;
 
Data My_Group.Test1;
Set myschema.mytable;
Run;
 
Proc Sql;

Create Table My_Group.Test1 as
	SELECT * FROM myschema.mytable;
 
Quit;
</code></pre></div><p>Hope these tips help some of you. If it did, let me know.</p>

      </div>


      <footer>
        


        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "tobybase-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
        
        
      </footer>
    </article>

    
  </section>

      </div>

      
  <footer class="footer">
    <section class="container">
      
        <p>Oracle Database Developer and Performance Tuner, specialized on the Exadata platform. Working for Infolob from Irving, Texas. #OCICertified </p>
      
      
        ¬©
        
          2012 -
        
        2020
         Toby Marks 
      
      
      
    </section>
  </footer>

    </main>

    

    

    

  </body>

</html>
